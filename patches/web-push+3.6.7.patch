diff --git a/node_modules/web-push/src/web-push-lib.js b/node_modules/web-push/src/web-push-lib.js
index a47df05..5c5c2c1 100644
--- a/node_modules/web-push/src/web-push-lib.js
+++ b/node_modules/web-push/src/web-push-lib.js
@@ -1,6 +1,5 @@
 'use strict';
 
-const url = require('url');
 const https = require('https');
 
 const WebPushError = require('./web-push-error.js');
@@ -271,7 +270,7 @@ WebPushLib.prototype.generateRequestDetails = function(subscription, payload, op
         requestDetails.headers.Authorization = 'key=' + currentGCMAPIKey;
       }
     } else if (currentVapidDetails) {
-      const parsedUrl = url.parse(subscription.endpoint);
+      const parsedUrl = new URL(subscription.endpoint);
       const audience = parsedUrl.protocol + '//'
       + parsedUrl.host;
 
@@ -345,10 +344,10 @@ WebPushLib.prototype.sendNotification = function(subscription, payload, options)
 
     return new Promise(function(resolve, reject) {
       const httpsOptions = {};
-      const urlParts = url.parse(requestDetails.endpoint);
+      const urlParts = new URL(requestDetails.endpoint);
       httpsOptions.hostname = urlParts.hostname;
       httpsOptions.port = urlParts.port;
-      httpsOptions.path = urlParts.path;
+      httpsOptions.path = urlParts.pathname + urlParts.search + urlParts.hash;
 
       httpsOptions.headers = requestDetails.headers;
       httpsOptions.method = requestDetails.method;
